# =============================================================================
# Local E2E Test Configuration
# =============================================================================
# Configuration for fully local end-to-end testing using Docker + Anvil + Canton.
# Uses Anvil's default mnemonic accounts for testing.
#
# Usage:
#   go run scripts/e2e-local.go [-cleanup]
#   ./scripts/e2e-local.sh
#
# =============================================================================

# Test participants (Anvil default accounts from mnemonic)
# Mnemonic: "test test test test test test test test test test test junk"
users:
  user1:
    # Account 1 from Anvil (0xf39...)
    private_key: "ac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80"
    address: "0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266"
    fingerprint: ""

  user2:
    # Account 2 from Anvil (0x70...)
    private_key: "59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d"
    address: "0x70997970C51812dc3A010C7d01b50e0d17dc79C8"
    fingerprint: ""

# Service endpoints (local docker compose)
services:
  relayer_url: "http://localhost:8080"
  api_server_url: "http://localhost:8081"
  # eth_rpc_url and register_url will be auto-generated if not specified

# Ethereum RPC configuration (for host-side scripts)
eth_rpc:
  chain_id: 31337
  # token_address will use contracts.token_address if not specified

# =============================================================================
# Required relayer config fields (for bootstrap-demo.go compatibility)
# =============================================================================

# Database configuration (local PostgreSQL)
database:
  host: "localhost"
  port: 5432
  user: "postgres"
  password: "p@ssw0rd"
  database: "erc20_api"
  ssl_mode: "disable"

# Ethereum config (required by config.Load validation)
ethereum:
  rpc_url: "http://localhost:8545"
  ws_url: "ws://localhost:8545"
  chain_id: 31337
  bridge_contract: "0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512"
  token_contract: "0x5FbDB2315678afecb367f032d93F642f64180aa3"
  relayer_private_key: "ac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80"
  confirmation_blocks: 1
  gas_limit: 300000
  max_gas_price: "100000000000"
  polling_interval: "5s"
  start_block: 0

# Canton config (required by config.Load validation and bootstrap-demo.go)
canton:
  rpc_url: "localhost:5011"
  ledger_id: "canton-ledger-id"
  domain_id: "local::1220baf58a5472a1931fe3b14dfd1e3b20cde8b5360088edb90587b8e6832faa486f"  # Auto-detected by bootstrap
  application_id: "canton-middleware"
  relayer_party: "BridgeIssuer::1220d7d0d8a45d6b2fcabeac1e38f67bd2bd40194b649a717ce5138c990f250e53e9"  # Auto-detected by bootstrap
  bridge_package_id: "96892a7be13d25a83b8772a1d3d4027cb39c7e65d60c879dc455a515e04e8b89"
  common_package_id: "5de6731c1a7487543d61ffe2bf847abbdf8694c4561c580986d8f4c2049745ea"
  core_package_id: "118e54e7f9619af76065036b0491f8f0911082dace8374d27d9b22ed98a1e665"
  cip56_package_id: "168483ce8a80e76f69f7392ceaa9ff57b1036b8fb41ccb3d410b087048195a92"
  splice_holding_package_id: "718a0f77e505a8de22f188bd4c87fe74101274e9d4cb1bfac7d09aec7158d35b"
  splice_transfer_package_id: "55ba4deb0ad4662c4168b39859738a0e91388d252286480c7331b3f71a517281"
  instrument_admin: "BridgeIssuer::1220d7d0d8a45d6b2fcabeac1e38f67bd2bd40194b649a717ce5138c990f250e53e9"  # Set by bootstrap (same as relayer_party)
  instrument_id: "PROMPT"
  bridge_module: "Wayfinder.Bridge"
  bridge_contract: "0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512"
  tls:
    enabled: false
  auth:
    client_id: "local-test-client"
    client_secret: "local-test-secret"
    audience: "http://canton:5011"
    token_url: "http://localhost:8088/oauth/token"
  polling_interval: "1s"

# Bridge config
bridge:
  max_transfer_amount: "1000000000000000000000"
  min_transfer_amount: "1000000000000000"
  rate_limit_per_hour: 100
  max_retries: 3
  retry_delay: "10s"
  processing_interval: "5s"

# =============================================================================
# Test-specific settings
# =============================================================================

# Test amounts
amounts:
  # Deposit 100 tokens (Anvil accounts have plenty of ETH)
  total_deposit: "100.0"
  # Transfer 25 tokens
  transfer_amount: "25.0"

# Contract addresses (deployed by docker compose)
# These are deterministic based on deployer script
contracts:
  # PromptToken deployed at this address by Foundry script
  token_address: "0x5FbDB2315678afecb367f032d93F642f64180aa3"
  # CantonBridge deployed at this address by Foundry script
  bridge_address: "0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512"
  # DEMO token (native Canton token) - synthetic address for MetaMask
  demo_token_address: "0x5FbDB2315678afecb367f032d93F642f64180aa3"

# DEMO token settings (native Canton token)
demo_token:
  name: "Demo Token"
  symbol: "DEMO"
  decimals: 18
  # Amount to mint to each user at bootstrap
  mint_amount: "500.0"

# Timeouts (shorter for local testing)
timeouts:
  deposit_confirmation: "60s"
  balance_update: "30s"
  rpc_call: "15s"

# Local test specific settings
local:
  # Docker compose files to use
  compose_files:
    - "docker-compose.yaml"
    - "docker-compose.local-test.yaml"
  # Anvil RPC URL
  anvil_url: "http://localhost:8545"
  # Canton HTTP URL
  canton_url: "http://localhost:5013"

