# =============================================================================
# Local E2E Test Configuration
# =============================================================================
# Configuration for fully local end-to-end testing using Docker + Anvil + Canton.
# Uses Anvil's default mnemonic accounts for testing.
#
# Usage:
#   go run scripts/e2e-local.go [-cleanup]
#   ./scripts/e2e-local.sh
#
# =============================================================================

# Test participants (Anvil default accounts from mnemonic)
# Mnemonic: "test test test test test test test test test test test junk"
users:
  user1:
    # Account 1 from Anvil (0xf39...)
    private_key: "ac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80"
    address: "0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266"
    fingerprint: ""

  user2:
    # Account 2 from Anvil (0x70...)
    private_key: "59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d"
    address: "0x70997970C51812dc3A010C7d01b50e0d17dc79C8"
    fingerprint: ""

# Service endpoints (local docker compose)
services:
  relayer_url: "http://localhost:8080"
  api_server_url: "http://localhost:8081"
  # eth_rpc_url and register_url will be auto-generated if not specified

# Ethereum RPC configuration (for host-side scripts)
eth_rpc:
  chain_id: 31337
  # token_address will use contracts.token_address if not specified

# =============================================================================
# Required relayer config fields (for bootstrap-demo.go compatibility)
# =============================================================================

# Database configuration (local PostgreSQL)
database:
  host: "localhost"
  port: 5432
  user: "postgres"
  password: "p@ssw0rd"
  database: "erc20_api"
  ssl_mode: "disable"

# Ethereum config (required by config.Load validation)
ethereum:
  rpc_url: "http://localhost:8545"
  ws_url: "ws://localhost:8545"
  chain_id: 31337
  bridge_contract: "0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512"
  token_contract: "0x5FbDB2315678afecb367f032d93F642f64180aa3"
  relayer_private_key: "ac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80"
  confirmation_blocks: 1
  gas_limit: 300000
  max_gas_price: "100000000000"
  polling_interval: "5s"
  start_block: 0

# Canton config (required by config.Load validation and bootstrap-demo.go)
canton:
  rpc_url: "localhost:5011"
  ledger_id: "canton-ledger-id"
  domain_id: ""  # Auto-detected by bootstrap
  application_id: "canton-middleware"
  relayer_party: ""  # Auto-detected by bootstrap
  bridge_package_id: "d96995a49cd9e3408e122a58a1db3a725251f9999ea7ffe2236ce4a045e675ba"
  core_package_id: "e097fc72886638d3cc8f2328ce63994bcfc45f280ef11b0d5511676a1c431854"
  cip56_package_id: "c091a84c30b517faa6b702c10a0169d2e09541a24fa1355abc4dbfaafc6d4c2b"
  native_token_package_id: "ac82e23c515461dbb683a0565a1e5f02ab2e23193d77d2f141f8f4d98b812458"
  bridge_module: "Wayfinder.Bridge"
  bridge_contract: "WayfinderBridgeConfig"
  tls:
    enabled: false
  auth:
    client_id: "local-test-client"
    client_secret: "local-test-secret"
    audience: "http://canton:5011"
    token_url: "http://localhost:8088/oauth/token"
  polling_interval: "1s"

# Bridge config
bridge:
  max_transfer_amount: "1000000000000000000000"
  min_transfer_amount: "1000000000000000"
  rate_limit_per_hour: 100
  max_retries: 3
  retry_delay: "10s"
  processing_interval: "5s"

# =============================================================================
# Test-specific settings
# =============================================================================

# Test amounts
amounts:
  # Deposit 100 tokens (Anvil accounts have plenty of ETH)
  total_deposit: "100.0"
  # Transfer 25 tokens
  transfer_amount: "25.0"

# Contract addresses (deployed by docker compose)
# These are deterministic based on deployer script
contracts:
  # PromptToken deployed at this address by Foundry script
  token_address: "0x5FbDB2315678afecb367f032d93F642f64180aa3"
  # CantonBridge deployed at this address by Foundry script  
  bridge_address: "0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512"
  # DEMO token (native Canton token) - synthetic address for MetaMask
  demo_token_address: "0xDE30000000000000000000000000000000000001"

# DEMO token settings (native Canton token)
demo_token:
  name: "Demo Token"
  symbol: "DEMO"
  decimals: 18
  # Amount to mint to each user at bootstrap
  mint_amount: "500.0"

# Timeouts (shorter for local testing)
timeouts:
  deposit_confirmation: "60s"
  balance_update: "30s"
  rpc_call: "15s"

# Local test specific settings
local:
  # Docker compose files to use
  compose_files:
    - "docker-compose.yaml"
    - "docker-compose.local-test.yaml"
  # Anvil RPC URL
  anvil_url: "http://localhost:8545"
  # Canton HTTP URL
  canton_url: "http://localhost:5013"

